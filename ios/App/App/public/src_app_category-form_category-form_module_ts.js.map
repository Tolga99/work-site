{"version":3,"file":"src_app_category-form_category-form_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;AAAyC;AACc;AAER;AAE/C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,wDAAY;KACxB;CACF,CAAC;IAMW,yBAAyB,SAAzB,yBAAyB;CAAG;AAA5B,yBAAyB;IAJrC,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,yBAAyB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;AChBG;AACM;AACF;AAEkB;AAEY;AAE5B;AACQ;AACE;IAc5C,kBAAkB,SAAlB,kBAAkB;CAAG;AAArB,kBAAkB;IAX9B,uDAAQ,CAAC;QACR,OAAO,EAAE;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,oFAAyB;YACzB,+DAAY;YACZ,mEAAqB;SACtB;QACD,YAAY,EAAE,CAAC,wDAAY,CAAC;KAC7B,CAAC;GACW,kBAAkB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxB/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAOaa,YAAY,SAAZA,YAAY;EAsBvBC,YAAoBC,MAApB,EAA6CC,cAA7C,EAAoFC,MAApF,EACoBC,KADpB,EAEoBC,cAFpB,EAEmD;IAF/B;IAAyB;IAAuC;IAChE;IACA;IApBpB,cAAS,EAAT,CAoBmD,CAZnD;;IACA,eAA4B,EAA5B;IACA,eAAU,IAAIhB,4DAAJ,CAAqB;MAC7BiB,YAAY,EAAE,IAAIlB,8DAAJ,CAAuB,EAAvB,EAA0BE,+DAA1B,CADe;MAE7BkB,WAAW,EAAE,IAAIpB,8DAAJ,CAAuB,EAAvB,CAFgB;MAG7BqB,WAAW,EAAE,IAAIrB,8DAAJ,CAAuB,EAAvB;IAHgB,CAArB,CAAV;IAOO,aAAQ,IAAIO,8DAAJ,CAAmB,KAAKM,MAAxB,CAAR;EAKN;;EAEDS,WAAW;IACTC,OAAO,CAACC,GAAR,CAAY,SAAZ;EACH;;EACOC,QAAQ;IAAA;;IAAA;MAEZ,KAAI,CAACC,OAAL,SAAoB,KAAI,CAACZ,cAAL,CAAoBa,GAApB,CAAwB,YAAxB,CAApB;MACA,IAAG,KAAI,CAACD,OAAL,IAAc,IAAjB,EACE,KAAI,CAACA,OAAL,GAAe,IAAIE,KAAJ,EAAf;MAEF,KAAI,CAACC,KAAL,GAAa,KAAI,CAACb,KAAL,CAAWc,QAAX,CAAoBC,QAApB,CAA6BJ,GAA7B,CAAiC,OAAjC,CAAb;MACA,KAAI,CAACK,QAAL,GAAgB,KAAI,CAACN,OAAL,CAAaO,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,KAAI,CAACnB,KAAL,CAAWc,QAAX,CAAoBC,QAApB,CAA6BJ,GAA7B,CAAiC,UAAjC,CAAxC,CAAhB,CAPY,CAQZ;;MACA,KAAI,CAACS,SAAL,GAAiB,KAAI,CAACpB,KAAL,CAAWc,QAAX,CAAoBC,QAApB,CAA6BJ,GAA7B,CAAiC,WAAjC,CAAjB;;MAIA,IAAG,KAAI,CAACE,KAAL,KAAe,KAAf,IAAwB,KAAI,CAACG,QAAL,KAAkB,IAA7C,EACA;QACET,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2B,KAAI,CAACK,KAAhC,EADF,CAEE;QACA;;QACA,IAAIQ,WAAJ;QACE,IAAG,KAAI,CAACL,QAAL,CAAcM,cAAd,IAA8B,IAAjC,EACED,WAAW,GAAG,KAAI,CAACL,QAAL,CAAcM,cAAd,CAA6BH,UAA3C,CADF,KAEKE,WAAW,GAAC,EAAZ;QACL,KAAI,CAACE,KAAL,GAAY,KAAI,CAACP,QAAL,CAAcG,UAA1B;;QACA,KAAI,CAACK,OAAL,CAAaC,QAAb,CAAsB;UACpBvB,YAAY,EAAE,KAAI,CAACc,QAAL,CAAcd,YADR;UAEpBE,WAAW,EAAG,KAAI,CAACY,QAAL,CAAcZ,WAFR;UAGpBC,WAAW,EAAGgB;QAHM,CAAtB;;QAKA,IAAG,KAAI,CAACL,QAAL,CAAcU,aAAd,IAA6B,IAAhC,EACE,KAAI,CAACC,MAAL,GAAY,KAAI,CAACX,QAAL,EAAeU,aAA3B,CAfN,CAgBE;MACD,CAlBD,MAkBM;QACJ,KAAI,CAACb,KAAL,GAAY,IAAZ;QACAN,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuB,KAAI,CAACK,KAA5B;QACA,KAAI,CAACU,KAAL,GAAY,KAAI,CAACK,YAAL,EAAZ;QACA,IAAG,KAAI,CAACR,SAAL,IAAgB,IAAnB,EACE,KAAI,CAACI,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCc,QAAhC,CAAyC,KAAI,CAACL,SAA9C;MACH;IArCW;EAsCb;;EAEKS,cAAc;IAAA;EAEnB;;EAEI,IAADC,CAAC;IACH,OAAO,KAAKN,OAAL,CAAaO,QAApB;EACD;;EAEDC,YAAY,CAACC,KAAD,EAAM;IAChB,IAAIA,KAAK,CAACC,MAAN,CAAaC,KAAb,IAAsBF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAA1B,EACA;MACE,MAAMC,WAAW,GAAGH,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBE,MAAvC;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAApB,EAAiCE,CAAC,EAAlC,EACA;QACE,MAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;QACAD,MAAM,CAACE,MAAP,GAAiBR,KAAD,IAAc;UAE5B1B,OAAO,CAACC,GAAR,CAAYyB,KAAK,CAACC,MAAN,CAAaQ,MAAzB;UACA,KAAKf,MAAL,GAAYM,KAAK,CAACC,MAAN,CAAaQ,MAAzB;UACA,KAAKlB,OAAL,CAAamB,UAAb,CAAwB;YACxBC,UAAU,EAAE,KAAKjB;UADO,CAAxB;QAGD,CAPD;;QAQAY,MAAM,CAACM,aAAP,CAAqBZ,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBG,CAAnB,CAArB;MACD;IACF;EACF;;EACKQ,QAAQ;IAAA;;IAAA;MAEZ,IAAIC,MAAM,GAAG,IAAb;MACA,MAAMC,OAAO,GAAG,EAAhB;MACA,MAAMjB,QAAQ,GAAG,MAAI,CAACP,OAAL,CAAaO,QAA9B;;MACA,KAAK,MAAMkB,IAAX,IAAmBlB,QAAnB,EAA6B;QAC3B,IAAIA,QAAQ,CAACkB,IAAD,CAAR,CAAeD,OAAnB,EAA4B;UACxB,IAAIE,GAAG,GAAC,EAAR;UACA,IAAGD,IAAI,KAAG,aAAV,EACEC,GAAG,GAAC,eAAJ;;UACF,IAAGD,IAAI,KAAK,aAAZ,EACA;YACE1C,OAAO,CAACC,GAAR,CAAY,yBAAZ;YACAuC,MAAM,GAAC,KAAP;UACD;;UACDC,OAAO,CAACG,IAAR,CAAaD,GAAb;QACH;MACF;;MACD,IAAI,CAAC,MAAI,CAAC1B,OAAL,CAAa4B,KAAlB,EACA;QACE,IAAIC,GAAG,GAAW,IAAlB;QACA,MAAM,MAAI,CAACC,KAAL,CAAWC,IAAX,CAAgB,OAAhB,EAAwBP,OAAO,CAACQ,QAAR,EAAxB,EACLC,IADK,CACAf,MAAM,IAAIA,MAAM,CAACA,MAAP,CACbe,IADa,CACPC,IAAD,IAAS;UACbL,GAAG,GAAC,IAAJ;QACD,CAHa,EAGVM,MAAD,IAAW;UACdN,GAAG,GAAC,SAAJ;QAAe,CAJD,CADV,CAAN;QAOE;MACH;;MACH,IAAGN,MAAM,KAAK,KAAd,EACA;QACE,MAAI,CAACa,SAAL,GAAiB,IAAjB;MACD,CAHD,MAIA;QACE,MAAI,CAACA,SAAL,GAAiB,MAAI,CAAClD,OAAL,CAAaO,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACK,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCkD,KAAxE,CAAjB;MACD;;MACD,IAAG,MAAI,CAAChD,KAAL,KAAe,KAAlB,EACA;QACE;QACA,IAAI,MAAI,CAACG,QAAL,CAAcM,cAAlB,EACA;UACE,MAAMwC,OAAO,GAAC,MAAI,CAAC9C,QAAL,CAAcM,cAAd,CAA6ByC,aAA3C;UACAD,OAAO,CAACE,MAAR,CAAeF,OAAO,CAACG,SAAR,CAAkB/C,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACH,QAAL,CAAcG,UAAtD,CAAf,EAAiF,CAAjF;UACA,MAAI,CAACT,OAAL,CAAa,MAAI,CAACA,OAAL,CAAauD,SAAb,CAAuB/C,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACH,QAAL,CAAcM,cAAd,CAA6BH,UAA1E,CAAb,EAAoG4C,aAApG,GAAkHD,OAAlH;QACD;;QAED,MAAI,CAACI,GAAL,GAAW,IAAI1E,sDAAJ,CACT,MAAI,CAAC+B,KADI,EAET,MAAI,CAACC,OAAL,CAAab,GAAb,CAAiB,cAAjB,EAAiCkD,KAFxB,EAGT,MAAI,CAACrC,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCkD,KAHvB,EAIT,MAAI,CAACD,SAJI,EAKT,MAAI,CAAClD,OAAL,CAAaO,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACH,QAAL,CAAcG,UAAtD,EAAkE4C,aALzD,EAMT,MAAI,CAACpC,MANI,CAAX;MAQD,CAlBD,MAmBA;QACI,MAAI,CAACuC,GAAL,GAAW,IAAI1E,sDAAJ,CACX,MAAI,CAAC+B,KADM,EAEX,MAAI,CAACC,OAAL,CAAab,GAAb,CAAiB,cAAjB,EAAiCkD,KAFtB,EAGX,MAAI,CAACrC,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCkD,KAHrB,EAIX,MAAI,CAACD,SAJM,EAKX,IALW,EAMX,MAAI,CAACjC,MANM,CAAX;MAQH;;MAEC,IAAGoB,MAAM,KAAK,IAAd,EACA;QACE;QACA,IAAG,MAAI,CAACa,SAAL,IAAgB,IAAnB,EACA;UACE,IAAG,MAAI,CAACA,SAAL,CAAeG,aAAf,IAA8B,IAAjC,EACE,MAAI,CAACH,SAAL,CAAeG,aAAf,GAA+B,IAAInD,KAAJ,EAA/B;;UACF,MAAI,CAACgD,SAAL,CAAeG,aAAf,CAA6BZ,IAA7B,CAAkC,MAAI,CAACe,GAAvC;;UACA,MAAI,CAACxD,OAAL,CAAa,MAAI,CAACA,OAAL,CAAauD,SAAb,CAAuB/C,CAAC,IAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACyC,SAAL,CAAezC,UAA5D,CAAb,IAAwF,MAAI,CAACyC,SAA7F;QAED;MAEF;;MACD,IAAG,MAAI,CAAC/C,KAAL,KAAa,KAAhB,EACA;QACE,MAAMsD,SAAS,GAAG,MAAI,CAACzD,OAAL,CAAauD,SAAb,CAAuBG,CAAC,IAAIA,CAAC,CAACjD,UAAF,KAAiB,MAAI,CAAC+C,GAAL,CAAS/C,UAAtD,CAAlB,CADF,CAEE;;;QACA,MAAI,CAACT,OAAL,CAAayD,SAAb,IAA0B,MAAI,CAACD,GAA/B;;QACA,MAAI,CAACxD,OAAL,CAAa2D,OAAb,CAAqBC,OAAO,IAAG;UAC7B,IAAGA,OAAO,CAAChD,cAAR,IAAwB,IAA3B,EACA;YACE,IAAGgD,OAAO,CAAChD,cAAR,CAAuBH,UAAvB,KAAsC,MAAI,CAAC+C,GAAL,CAAS/C,UAAlD,EACA;cACEmD,OAAO,CAAChD,cAAR,GAAwB,MAAI,CAAC4C,GAA7B;YACD;UACF;;UACD,IAAGI,OAAO,CAACP,aAAR,IAAuB,IAA1B,EACA;YACEO,OAAO,CAACP,aAAR,CAAsBM,OAAtB,CAA8BC,OAAO,IAAG;cACtC,IAAGA,OAAO,CAACnD,UAAR,KAAuB,MAAI,CAAC+C,GAAL,CAAS/C,UAAnC,EACA;gBACEmD,OAAO,GAAG,MAAI,CAACJ,GAAf;cACD;YACF,CALD;UAMD;QACF,CAjBD;MAkBD,CAvBD,MAuBM,MAAI,CAACxD,OAAL,CAAayC,IAAb,CAAkB,MAAI,CAACe,GAAvB;;MAEN,MAAI,CAACpE,cAAL,CAAoByE,GAApB,CAAwB,YAAxB,EAAqC,MAAI,CAAC7D,OAA1C;;MAEAH,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB,MAAI,CAACE,OAA9B;;MACA,MAAI,CAACX,MAAL,CAAYyE,QAAZ,CAAqB,CAAC,WAAD,EAAa;QAACC,SAAS,EAAE,MAAI,CAACrD;MAAjB,CAAb,CAArB,EAA+D;QAACsD,UAAU,EAAC;MAAZ,CAA/D;IA5GY;EA6Gb;;EACD9C,YAAY;IAER,KAAK+C,SAAL,GAAerF,oDAAA,EAAf;IACA,OAAO,KAAKqF,SAAZ;EACH;;EACDC,WAAW;IAET,KAAKjD,MAAL,GAAY,EAAZ;IACA,OAAO,IAAP;EACD;;EACKkD,MAAM;IAAA;;IAAA;MAEV,IAAInC,MAAJ;MACAnC,OAAO,CAACC,GAAR,CAAY,MAAI,CAACK,KAAjB;;MACA,IAAG,MAAI,CAACA,KAAL,KAAe,IAAf,IAAuB,MAAI,CAACA,KAAL,KAAeiE,SAAzC,EACA;QACE,IAAIC,GAAG,GAAG,CAAV;QACAC,MAAM,CAACC,IAAP,CAAY,MAAI,CAACzD,OAAL,CAAaO,QAAzB,EAAmCsC,OAAnC,CAA2Ca,GAAG,IAAG;UAC/C,IAAG,CAAC,MAAI,CAACjF,cAAL,CAAoBkF,aAApB,CAAkC,MAAI,CAAC3D,OAAL,CAAaO,QAAb,CAAsBmD,GAAtB,EAA2BrB,KAA7D,CAAJ,EACA;YACEkB,GAAG;UACJ;QACF,CALD;QAMAxE,OAAO,CAACC,GAAR,CAAYuE,GAAZ,EAAgB,MAAI,CAACvD,OAArB;;QACA,IAAGuD,GAAG,GAAG,CAAT,EACA;UACErC,MAAM,SAAS,MAAI,CAAC0C,WAAL,EAAf;QACD;MACF,CAdD,MAeA;QACE,IAAIrC,MAAM,GAAG,EAAb;QACA,IAAG,MAAI,CAAC/B,QAAL,CAAcM,cAAd,KAAiC,IAAjC,IAAyC,MAAI,CAACN,QAAL,CAAcM,cAAd,KAAiCwD,SAA7E,EACE/B,MAAM,GAAG,MAAI,CAAC/B,QAAL,CAAcM,cAAd,CAA6BH,UAAtC;;QACF,IAAG,CAAC,MAAI,CAAClB,cAAL,CAAoBoF,MAApB,CAA2B,MAAI,CAACrE,QAAL,CAAcd,YAAzC,EAAsD,MAAI,CAACsB,OAAL,CAAab,GAAb,CAAiB,cAAjB,EAAiCkD,KAAvF,CAAD,IACH,CAAC,MAAI,CAAC5D,cAAL,CAAoBoF,MAApB,CAA2B,MAAI,CAACrE,QAAL,CAAcZ,WAAzC,EAAqD,MAAI,CAACoB,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCkD,KAArF,CADE,IAEH,CAAC,MAAI,CAAC5D,cAAL,CAAoBoF,MAApB,CAA2BtC,MAA3B,EAAkC,MAAI,CAACvB,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCkD,KAAlE,CAFD,EAGA;UACEnB,MAAM,SAAS,MAAI,CAAC0C,WAAL,EAAf;QACD;MACF;;MACD7E,OAAO,CAACC,GAAR,CAAYkC,MAAZ;MACA,IAAGA,MAAM,KAAK,IAAd,EACA,MAAI,CAAC3C,MAAL,CAAYyE,QAAZ,CAAqB,CAAC,UAAD,EAAY;QAACC,SAAS,EAAE,MAAI,CAACrD;MAAjB,CAAZ,CAArB,EAA8D;QAACsD,UAAU,EAAC;MAAZ,CAA9D;IAhCU;EAiCX;;EACKU,WAAW;IAAA;;IAAA;MAEf,IAAI/B,GAAG,GAAW,IAAlB;MACA,MAAM,MAAI,CAACC,KAAL,CAAWC,IAAX,CAAgB,UAAhB,EAA2B,EAA3B,EACLE,IADK,CACAf,MAAM,IAAIA,MAAM,CAACA,MAAP,CACbe,IADa,CACPC,IAAD,IAAS;QACbL,GAAG,GAAC,IAAJ;MACD,CAHa,EAGVM,MAAD,IAAW;QACdN,GAAG,GAAC,SAAJ;MAAgB,CAJF,CADV,CAAN;MAOA,IAAGA,GAAG,KAAK,SAAX,EACI,OAAO,IAAP;MACJ,OAAO,EAAP;IAZe;EAahB;;EACDiC,SAAS,CAACC,CAAD,EAAE;IACT,KAAK/D,OAAL,CAAab,GAAb,CAAiB,aAAjB,EAAgCc,QAAhC,CAAyC8D,CAAC,CAACrD,MAAF,CAAS2B,KAAlD,EAAyD;MACvD2B,QAAQ,EAAE;IAD6C,CAAzD;EAGD;;AA9QsB;;;QAZhBnG,gEAAQA;;QAKRK,qEAAcA;;QANEN,oDAAMA;;QAAtBD,4DAAcA;;QAKdM,qEAAcA;;;;;UAmCpBV,wDAAYA;IAAA0G,OAAC,UAAD;;;AA3BF9F,YAAY,uDALxBb,yDAAS,CAAC;EACT4G,QAAQ,EAAE,mBADD;EAETC,UAAAA,2DAFS;;AAAA,CAAD,CAKe,GAAZhG,YAAY,CAAZ;;;;;;;;;;;;;;;ACLN,MAAM,QAAQ;IACjB,YACW,UAAiB,EACjB,YAAmB,EACnB,WAAkB,EAClB,cAAuB,EACvB,aAA8B,EAC9B,aAAqB;QALrB,eAAU,GAAV,UAAU,CAAO;QACjB,iBAAY,GAAZ,YAAY,CAAO;QACnB,gBAAW,GAAX,WAAW,CAAO;QAClB,mBAAc,GAAd,cAAc,CAAS;QACvB,kBAAa,GAAb,aAAa,CAAiB;QAC9B,kBAAa,GAAb,aAAa,CAAQ;IAEhC,CAAC;CAEF","sources":["./src/app/category-form/category-form-routing.module.ts","./src/app/category-form/category-form.module.ts","./src/app/category-form/category-form.ts","./src/app/models/category.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CategoryForm } from './category-form';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CategoryForm\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CategoryFormRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule, IonIcon, IonItem } from '@ionic/angular';\n\nimport { CategoryFormRoutingModule } from './category-form-routing.module';\n\nimport { CategoryForm } from './category-form';\nimport { SharedModule } from '../shared/shared.module';\nimport { IonicSelectableModule } from 'ionic-selectable';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CategoryFormRoutingModule,\n    SharedModule,\n    IonicSelectableModule\n  ],\n  declarations: [CategoryForm]\n})\nexport class CategoryFormModule {}\n","import { Component, HostListener, OnDestroy, OnInit } from '@angular/core';\r\nimport { UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { UUID } from 'angular2-uuid';\r\nimport { NgbdModalFocus } from '../modal/modal-focus';\r\nimport { Category } from '../models/category';\r\nimport { MethodsService } from '../services/methods.service';\r\nimport { StorageService } from '../services/storage.service';\r\n\r\n@Component({\r\n  selector: 'app-category-form',\r\n  templateUrl: './category-form.html',\r\n  styleUrls: ['./category-form.scss'],\r\n})\r\nexport class CategoryForm implements OnInit,OnDestroy {\r\n\r\n  selectedCategory : Category;\r\n  uuidValue: string;\r\n  images = '';\r\n  // chantierId: string;\r\n  catId: string;\r\n  ActualCat : string;\r\n  modif : string;\r\n  modifCat : Category;\r\n  cat : Category;\r\n  parentCat : Category;\r\n  // indexFind: number;\r\n  catList : Array<Category> = [];\r\n  formCat = new UntypedFormGroup({\r\n    categoryName: new UntypedFormControl('',Validators.required),\r\n    description: new UntypedFormControl(''),\r\n    categoryPar: new UntypedFormControl(''),\r\n  });\r\n  selectedCat : string;\r\n\r\n  public modal = new NgbdModalFocus(this.modalS);\r\n  constructor(private modalS :NgbModal,private storageService:StorageService, private router: Router, \r\n              private route: ActivatedRoute,\r\n              private methodsService : MethodsService)\r\n  {\r\n  }\r\n  @HostListener('unloaded')\r\n  ngOnDestroy() {\r\n    console.log('Cleared');\r\n}\r\n  async ngOnInit() {\r\n\r\n    this.catList =await this.storageService.get('Categories');\r\n    if(this.catList==null)\r\n      this.catList = new Array<Category>();\r\n\r\n    this.modif = this.route.snapshot.paramMap.get('modif');\r\n    this.modifCat = this.catList.find(a => a.categoryId === this.route.snapshot.paramMap.get('modifCat'));\r\n    // this.chantierId = this.route.snapshot.paramMap.get('chantierId');\r\n    this.ActualCat = this.route.snapshot.paramMap.get('actualCat');\r\n\r\n\r\n\r\n    if(this.modif === 'YES' && this.modifCat !== null)\r\n    {\r\n      console.log('modification',this.modif);\r\n      // if(this.indexFind>=0)\r\n      // {\r\n      let catParentId :string;\r\n        if(this.modifCat.categoryParent!=null)\r\n          catParentId = this.modifCat.categoryParent.categoryId;\r\n        else catParentId='';\r\n        this.catId= this.modifCat.categoryId;\r\n        this.formCat.setValue({\r\n          categoryName: this.modifCat.categoryName,\r\n          description:  this.modifCat.description,\r\n          categoryPar:  catParentId,\r\n        });\r\n        if(this.modifCat.categoryImage!=null)\r\n          this.images=this.modifCat?.categoryImage;\r\n      // }\r\n    }else {\r\n      this.modif= 'NO';\r\n      console.log('creation',this.modif);\r\n      this.catId= this.generateUUID();\r\n      if(this.ActualCat!=null)\r\n        this.formCat.get('categoryPar').setValue(this.ActualCat);\r\n    }\r\n  }\r\n\r\n  async CreateWorksite() {\r\n\r\n  }\r\n\r\n  get f(){\r\n    return this.formCat.controls;\r\n  }\r\n\r\n  onFileChange(event) {\r\n    if (event.target.files && event.target.files[0])\r\n    {\r\n      const filesAmount = event.target.files.length;\r\n      for (let i = 0; i < filesAmount; i++)\r\n      {\r\n        const reader = new FileReader();\r\n        reader.onload = (event:any) =>\r\n        {\r\n          console.log(event.target.result);\r\n          this.images=event.target.result;\r\n          this.formCat.patchValue({\r\n          fileSource: this.images\r\n          });\r\n        }\r\n        reader.readAsDataURL(event.target.files[i]);\r\n      }\r\n    }\r\n  }\r\n  async onSubmit()\r\n  {\r\n    let parent = true;\r\n    const invalid = [];\r\n    const controls = this.formCat.controls;\r\n    for (const name in controls) {\r\n      if (controls[name].invalid) {\r\n          let nom='';\r\n          if(name==='productName')\r\n            nom='Nom catÃ©gorie';\r\n          if(name === 'categoryPar')\r\n          {\r\n            console.log('Pas de categorie parent');\r\n            parent=false;\r\n          }\r\n          invalid.push(nom);\r\n      }\r\n    }\r\n    if (!this.formCat.valid)\r\n    {\r\n      let res : string =null;\r\n      await this.modal.open('field',invalid.toString())\r\n      .then(result => result.result\r\n        .then((data) => {\r\n          res='OK';\r\n        }, (reason) => {\r\n        res='DISMISS' }\r\n        ));\r\n        return;\r\n    }\r\n  if(parent === false)\r\n  {\r\n    this.parentCat = null;\r\n  }else\r\n  {\r\n    this.parentCat = this.catList.find(a => a.categoryId === this.formCat.get('categoryPar').value);\r\n  }\r\n  if(this.modif === 'YES')\r\n  {\r\n    // RETRAIT DE LA CATEGORIE PARENT si il y'en a\r\n    if (this.modifCat.categoryParent)\r\n    {\r\n      const subCats=this.modifCat.categoryParent.subCategories;\r\n      subCats.splice(subCats.findIndex(a => a.categoryId === this.modifCat.categoryId),1);\r\n      this.catList[this.catList.findIndex(a => a.categoryId === this.modifCat.categoryParent.categoryId)].subCategories=subCats;\r\n    }\r\n\r\n    this.cat = new Category(\r\n      this.catId,\r\n      this.formCat.get('categoryName').value,\r\n      this.formCat.get('description').value,\r\n      this.parentCat,\r\n      this.catList.find(a => a.categoryId === this.modifCat.categoryId).subCategories,\r\n      this.images,\r\n    );\r\n  }else\r\n  {\r\n      this.cat = new Category(\r\n      this.catId,\r\n      this.formCat.get('categoryName').value,\r\n      this.formCat.get('description').value,\r\n      this.parentCat,\r\n      null,\r\n      this.images,\r\n    );\r\n  }\r\n\r\n    if(parent === true)\r\n    {\r\n      // AJOUT DE LA CATEGORIE PARENT\r\n      if(this.parentCat!=null)\r\n      {\r\n        if(this.parentCat.subCategories==null)\r\n          this.parentCat.subCategories = new Array<Category>();\r\n        this.parentCat.subCategories.push(this.cat);\r\n        this.catList[this.catList.findIndex(a => a.categoryId === this.parentCat.categoryId)] = this.parentCat;\r\n\r\n      }\r\n\r\n    }\r\n    if(this.modif==='YES')\r\n    {\r\n      const indexFind = this.catList.findIndex(x => x.categoryId === this.cat.categoryId);\r\n      // this.catList.splice(indexFind,1);\r\n      this.catList[indexFind] = this.cat;\r\n      this.catList.forEach(element => {\r\n        if(element.categoryParent!=null)\r\n        {\r\n          if(element.categoryParent.categoryId === this.cat.categoryId)\r\n          {\r\n            element.categoryParent= this.cat;\r\n          }\r\n        }\r\n        if(element.subCategories!=null)\r\n        {\r\n          element.subCategories.forEach(element => {\r\n            if(element.categoryId === this.cat.categoryId)\r\n            {\r\n              element = this.cat;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }else this.catList.push(this.cat);\r\n\r\n    this.storageService.set('Categories',this.catList);\r\n\r\n    console.log('cat saved', this.catList);\r\n    this.router.navigate(['/articles',{actualCat: this.ActualCat}],{replaceUrl:true});\r\n  }\r\n  generateUUID()\r\n  {\r\n      this.uuidValue=UUID.UUID();\r\n      return this.uuidValue;\r\n  }\r\n  resetImages()\r\n  {\r\n    this.images='';\r\n    return null;\r\n  }\r\n  async GoBack()\r\n  {\r\n    var result : string | undefined;\r\n    console.log(this.modif);\r\n    if(this.modif === 'NO' || this.modif === undefined)\r\n    {\r\n      let cpt = 0;\r\n      Object.keys(this.formCat.controls).forEach(key => {\r\n        if(!this.methodsService.isNullOrEmpty(this.formCat.controls[key].value))\r\n        {\r\n          cpt ++;\r\n        }\r\n      });\r\n      console.log(cpt,this.formCat);\r\n      if(cpt > 0)\r\n      {\r\n        result = await this.GoBackModal();\r\n      }\r\n    }else\r\n    {\r\n      let parent = '';\r\n      if(this.modifCat.categoryParent !== null && this.modifCat.categoryParent !== undefined)\r\n        parent = this.modifCat.categoryParent.categoryId;\r\n      if(!this.methodsService.equals(this.modifCat.categoryName,this.formCat.get('categoryName').value) ||\r\n      !this.methodsService.equals(this.modifCat.description,this.formCat.get('description').value) ||\r\n      !this.methodsService.equals(parent,this.formCat.get('categoryPar').value))\r\n      {\r\n        result = await this.GoBackModal();\r\n      }\r\n    }\r\n    console.log(result);\r\n    if(result !== null)\r\n    this.router.navigate(['articles',{actualCat: this.ActualCat}],{replaceUrl:true});\r\n  }\r\n  async GoBackModal() : Promise<string>\r\n  {\r\n    let res : string =null;\r\n    await this.modal.open('exitPage','')\r\n    .then(result => result.result\r\n      .then((data) => {\r\n        res='OK';\r\n      }, (reason) => {\r\n      res='DISMISS'; }\r\n      ));\r\n    if(res === 'DISMISS')\r\n        return null;\r\n    return '';\r\n  }\r\n  changePar(e) {\r\n    this.formCat.get('categoryPar').setValue(e.target.value, {\r\n      onlySelf: true\r\n    })\r\n  }\r\n}","export interface ICategory\r\n{\r\n    categoryId:string;\r\n    categoryName: string;\r\n    description: string;\r\n    categoryParent: Category;\r\n    subCategories: Array<Category>;\r\n    categoryImage: string;\r\n}\r\n\r\nexport class Category implements ICategory {\r\n    constructor(\r\n        public categoryId:string,\r\n        public categoryName:string,\r\n        public description:string,\r\n        public categoryParent:Category,\r\n        public subCategories: Array<Category>,\r\n        public categoryImage: string,\r\n    ) {\r\n    }\r\n\r\n  }"],"names":["Component","HostListener","UntypedFormControl","UntypedFormGroup","Validators","ActivatedRoute","Router","NgbModal","UUID","NgbdModalFocus","Category","MethodsService","StorageService","CategoryForm","constructor","modalS","storageService","router","route","methodsService","categoryName","required","description","categoryPar","ngOnDestroy","console","log","ngOnInit","catList","get","Array","modif","snapshot","paramMap","modifCat","find","a","categoryId","ActualCat","catParentId","categoryParent","catId","formCat","setValue","categoryImage","images","generateUUID","CreateWorksite","f","controls","onFileChange","event","target","files","filesAmount","length","i","reader","FileReader","onload","result","patchValue","fileSource","readAsDataURL","onSubmit","parent","invalid","name","nom","push","valid","res","modal","open","toString","then","data","reason","parentCat","value","subCats","subCategories","splice","findIndex","cat","indexFind","x","forEach","element","set","navigate","actualCat","replaceUrl","uuidValue","resetImages","GoBack","undefined","cpt","Object","keys","key","isNullOrEmpty","GoBackModal","equals","changePar","e","onlySelf","args","selector","template"],"sourceRoot":"webpack:///"}