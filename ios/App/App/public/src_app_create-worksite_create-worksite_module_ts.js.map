{"version":3,"file":"src_app_create-worksite_create-worksite_module_ts.js","mappings":"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","sources":["./src/app/create-worksite/create-worksite-routing.module.ts","./src/app/create-worksite/create-worksite.module.ts","./src/app/create-worksite/create-worksite.ts","./src/app/explore-container/explore-container.component.ts","./src/app/explore-container/explore-container.module.ts","./src/app/create-worksite/create-worksite.html","./src/app/explore-container/explore-container.component.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { CreateWorksite } from './create-worksite';\r\n\r\nconst routes: Routes = [\r\n    {\r\n    path: '',\r\n    component: CreateWorksite,\r\n  }\r\n];\r\n\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class CreateWorksiteRoutingModule {}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { CreateWorksite } from './create-worksite';\nimport { IonicModule } from '@ionic/angular';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\nimport { SharedModule } from '../shared/shared.module';\nimport { CreateWorksiteRoutingModule } from './create-worksite-routing.module';\n\n\n\n@NgModule({\n  declarations: [CreateWorksite],\n  imports: [\n    IonicModule,\n    CommonModule,\n    SharedModule,\n    ExploreContainerComponentModule,\n    CreateWorksiteRoutingModule\n  ]\n})\nexport class CreateWorksiteModule { }\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\r\nimport { StorageService } from '../services/storage.service';\r\nimport { UUID } from 'angular2-uuid';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Chantier } from '../models/chantier';\r\nimport { User } from '../models/user';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { NgbdModalFocus } from '../modal/modal-focus';\r\n\r\n@Component({\r\n  selector: 'app-createworksite',\r\n  templateUrl: 'create-worksite.html',\r\n  styleUrls: ['create-worksite.scss']\r\n})\r\nexport class CreateWorksite implements OnInit {\r\n  newWorksite : Chantier;\r\n  client : User;\r\n  uuidValue : string;\r\n  public chantierList : Array<Chantier> = [];\r\n  clientList : Array<User> = [];\r\n  date : string;\r\n  userId : string;\r\n  formWork = new FormGroup({\r\n    worksiteName: new FormControl('',Validators.required),\r\n    client: new FormControl('', Validators.required),\r\n    description: new FormControl(''),\r\n    address : new FormControl(''),\r\n  });\r\n\r\n  public modal = new NgbdModalFocus(this.modalS);\r\n  constructor(private modalS :NgbModal,private storageService:StorageService, private router: Router,private route:ActivatedRoute)\r\n  {\r\n  }\r\n  async ionViewDidEnter(){\r\n    console.log('view did enter');\r\n    //this.storageService.init();\r\n    //this.clientList = await this.storageService.get('Contacts');\r\n\r\n  }\r\n  async ngOnInit() {\r\n    const nowDate = new Date();\r\n    this.date = nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear();\r\n\r\n    this.userId = this.route.snapshot.paramMap.get('userId');\r\n    console.log(this.userId);\r\n    this.storageService.init();\r\n    this.clientList = await this.storageService.get('Contacts');\r\n    console.log(this.clientList);\r\n    if(this.userId !== null)\r\n    {\r\n      this.formWork.get('client').setValue(this.clientList.find(a => a.userId === this.userId).userId);\r\n      // this.formWork.get('client').setValue(this.clientList.find(a => a.userId === this.userId));\r\n      // this.formWork.get('client').setValue(this.clientList.find(a => a.userId === this.userId).userId);\r\n     // this.formWork.patchValue({client : this.clientList.find(a => a.userId === this.userId).lastName.toUpperCase()});\r\n    }\r\n  }\r\n\r\n  async CreateWorksite() {\r\n    const invalid = [];\r\n    const controls = this.formWork.controls;\r\n    for (const name in controls) {\r\n      if (controls[name].invalid) {\r\n          let nom='';\r\n          if(name==='worksiteName')\r\n            nom='Nom chantier';\r\n          if(name === 'client')\r\n            nom='Client';\r\n          invalid.push(nom);\r\n      }\r\n    }\r\n    if (!this.formWork.valid)\r\n    {\r\n      let res : string =null;\r\n      await this.modal.open('field',invalid.toString())\r\n      .then(result => result.result\r\n        .then((data) => {\r\n          res='OK';\r\n        }, (reason) => {\r\n        res='DISMISS' }\r\n        ));\r\n        return;\r\n    }\r\n    this.client = this.clientList.find(x => x.userId === this.formWork.get('client').value);\r\n    this.storageService.init();\r\n    this.newWorksite = new Chantier(\r\n      this.generateUUID(),\r\n      this.formWork.get('worksiteName').value,\r\n      // this.client.lastName,\r\n      this.client.userId,\r\n      this.formWork.get('description').value,\r\n      this.formWork.get('address').value,\r\n      this.date,\r\n      null,\r\n      'En cours',\r\n      null,\r\n      null,\r\n      null,\r\n      null,\r\n      null,\r\n    );\r\n\r\n    this.chantierList=await this.storageService.get('Chantiers');\r\n    if(this.chantierList==null)\r\n      this.chantierList=[];\r\n    this.chantierList.push(this.newWorksite);\r\n    this.storageService.set('Chantiers',this.chantierList);\r\n\r\n    if(this.client.historique==null)\r\n      this.client.historique= new Array<string>();\r\n    this.client.historique.push(this.newWorksite.chantierId);\r\n\r\n    this.clientList[this.clientList.findIndex(a => a.userId == this.client.userId)] = this.client;\r\n    this.storageService.set('Contacts', this.clientList);\r\n    console.log('Chantier crée, redirection...');\r\n    this.router.navigate(['/tb-home'],{replaceUrl:true});\r\n  }\r\n  NewClient()\r\n  {\r\n    console.log('create client');\r\n    this.router.navigate(['new-contact',{tag: 'chantier'}],{replaceUrl:true});\r\n  }\r\n  generateUUID()\r\n  {\r\n      this.uuidValue=UUID.UUID();\r\n      return this.uuidValue;\r\n  }\r\n  selectClient(event: Event) {\r\n    const s = (event.target as HTMLSelectElement).value;\r\n    this.formWork.patchValue({address : this.clientList.find(a => a.userId === s).address});\r\n  }\r\n  GoBack()\r\n  {\r\n    this.router.navigate(['tb-home'],{replaceUrl:true});\r\n  }\r\n}\r\n\r\n","import { Component, OnInit, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-explore-container',\r\n  templateUrl: './explore-container.component.html',\r\n  styleUrls: ['./explore-container.component.scss'],\r\n})\r\nexport class ExploreContainerComponent implements OnInit {\r\n  @Input() name: string;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {}\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ExploreContainerComponent } from './explore-container.component';\r\n\r\n@NgModule({\r\n  imports: [ CommonModule, FormsModule, IonicModule],\r\n  declarations: [ExploreContainerComponent],\r\n  exports: [ExploreContainerComponent]\r\n})\r\nexport class ExploreContainerComponentModule {}\r\n","export default \"<div class=\\\"container\\\" style=\\\"overflow-y: auto;\\\">\\r\\n  <ion-header>\\r\\n    <ion-toolbar>\\r\\n      <ion-button (click)=\\\"GoBack()\\\">\\r\\n        <ion-icon name=\\\"arrow-back\\\"></ion-icon>\\r\\n        <ion-label>Retour</ion-label>\\r\\n      </ion-button>\\r\\n    </ion-toolbar>\\r\\n  </ion-header>\\r\\n  <form [formGroup]=\\\"formWork\\\" (ngSubmit)=\\\"CreateWorksite()\\\">\\r\\n\\r\\n    <ion-item class=\\\"form-group\\\" required=\\\"required\\\">\\r\\n      <ion-label position=\\\"floating\\\">Nom chantier</ion-label>\\r\\n      <ion-input type=\\\"text\\\" id=\\\"name\\\" name=\\\"name\\\" formControlName=\\\"worksiteName\\\" placeholder=\\\"...\\\" required=\\\"required\\\"></ion-input>\\r\\n    </ion-item>\\r\\n\\r\\n    <ion-item>\\r\\n      <ion-label>Client</ion-label>\\r\\n      <ion-select interface=\\\"alert\\\" okText=\\\"Ok\\\" cancelText=\\\"Annuler\\\" formControlName=\\\"client\\\"\\r\\n        (change)=\\\"selectClient($event)\\\">\\r\\n        <ion-select-option></ion-select-option>\\r\\n        <ion-select-option *ngFor=\\\"let name of clientList\\\" [value]=\\\"name.userId\\\"> {{name.lastName.toUpperCase()}}\\r\\n          {{name.firstName}} </ion-select-option>\\r\\n      </ion-select>\\r\\n    </ion-item>\\r\\n    <button type=\\\"button\\\" (click)=\\\"NewClient()\\\">Nouveau client ?</button>\\r\\n\\r\\n    <hr>\\r\\n    <ion-item class=\\\"form-group\\\" required=\\\"required\\\">\\r\\n      <ion-label position=\\\"floating\\\">Adresse du chantier</ion-label>\\r\\n      <ion-input type=\\\"text\\\" id=\\\"address\\\" name=\\\"address\\\" formControlName=\\\"address\\\" placeholder=\\\"...\\\"></ion-input>\\r\\n    </ion-item>\\r\\n\\r\\n    <ion-item>\\r\\n      <ion-label position=\\\"floating\\\">Description</ion-label>\\r\\n      <ion-textarea id=\\\"description\\\" name=\\\"description\\\" formControlName=\\\"description\\\" placeholder=\\\"...\\\"\\r\\n        style=\\\"height:100px;\\\"></ion-textarea>\\r\\n    </ion-item>\\r\\n\\r\\n    <input type=\\\"submit\\\" value=\\\"Créer chantier\\\">\\r\\n  </form>\\r\\n</div>\";","export default \"<div id=\\\"container\\\">\\r\\n  <strong>{{ name }}</strong>\\r\\n  <p>Explore <a target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" href=\\\"https://ionicframework.com/docs/components\\\">UI Components</a></p>\\r\\n</div>\";"],"names":[],"sourceRoot":"webpack:///"}