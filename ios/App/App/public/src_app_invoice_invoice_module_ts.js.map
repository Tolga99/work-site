{"version":3,"file":"src_app_invoice_invoice_module_ts.js","mappings":"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","sources":["./src/app/invoice/invoice-routing.module.ts","./src/app/invoice/invoice.module.ts","./src/app/invoice/invoice.ts","./src/app/services/methods.service.ts","./node_modules/angular2-uuid/index.js"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { Invoice } from './invoice';\r\n\r\nconst routes: Routes = [\r\n    {\r\n    path: '',\r\n    component: Invoice,\r\n  }\r\n];\r\n\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class InvoiceRoutingModule {}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Invoice } from './invoice';\nimport { IonicModule } from '@ionic/angular';\nimport { SharedModule } from '../shared/shared.module';\nimport { InvoiceRoutingModule } from './invoice-routing.module';\n\n\n\n@NgModule({\n  declarations: [Invoice],\n  imports: [\n    IonicModule,\n    CommonModule,\n    SharedModule,\n    InvoiceRoutingModule\n  ]\n})\nexport class InvoiceModule { }\n","import { Component, OnInit } from '@angular/core';\r\nimport { UntypedFormGroup, UntypedFormControl, Validators } from '@angular/forms';\r\nimport { StorageService } from '../services/storage.service';\r\nimport { UUID } from 'angular2-uuid';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Facture } from '../models/facture';\r\nimport { Product } from '../models/product';\r\nimport { Chantier } from '../models/chantier';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { NgbdModalFocus } from '../modal/modal-focus';\r\nimport { NavController, NumericValueAccessor } from '@ionic/angular';\r\nimport { ShoppingCart } from '../models/shoppingCart';\r\nimport { InvoiceSettings } from '../models/Settings/invoiceSettings';\r\nimport { stringify } from 'querystring';\r\nimport { throws } from 'assert';\r\nimport { MethodsService } from '../services/methods.service';\r\n\r\n@Component({\r\n  selector: 'app-invoice',\r\n  templateUrl: 'invoice.html',\r\n  styleUrls: ['invoice.scss']\r\n})\r\nexport class Invoice implements OnInit {\r\n\r\n  public allowedPageSizes = [3, 6, 9];\r\n  displayMode = 'full';\r\n  showPageSizeSelector = true;\r\n  showInfo = true;\r\n  showNavButtons = true;\r\n\r\n  uuidValue: string;\r\n  images = [];\r\n  chantierId: string;\r\n  invoiceId: string;\r\n  ScanMode: boolean; // Si = false -> on est en mode création -- donc on voit TVA REMISE PHOTO\r\n                          // true = mode\r\n  mode : string;\r\n  type : string;\r\n  date: string;\r\n  inv : Facture;\r\n  invSettings : InvoiceSettings;\r\n  indexFind: number;\r\n  invList : Array<Facture> = [];\r\n  receivedMoney: Array<{ price: number, date: string}>;\r\n\r\n  headElementsArt = ['Nom article', 'Description','Prix Unitaire','Quantité','Prix total',''];\r\n\r\n  panierList : Array<ShoppingCart> = [];\r\n  numericNumberReg= '^-?[0-9]\\\\d*(\\\\.\\\\d{1,2})?$';\r\n\r\n  formInv = new UntypedFormGroup({\r\n    factureName: new UntypedFormControl('',Validators.required),\r\n    description: new UntypedFormControl(''),\r\n    typePay: new UntypedFormControl('', [Validators.required]),\r\n    priceHtva: new UntypedFormControl('',Validators.pattern(this.numericNumberReg)),\r\n    tva: new UntypedFormControl('',Validators.pattern(this.numericNumberReg)),\r\n    remise: new UntypedFormControl('',Validators.pattern(this.numericNumberReg)),\r\n    totalPrice : new UntypedFormControl('',Validators.pattern(this.numericNumberReg)),\r\n  });\r\n  public modal = new NgbdModalFocus(this.modalS);\r\n  constructor(private modalS :NgbModal,private storageService:StorageService,\r\n    private router: Router, private route: ActivatedRoute, private methodsService : MethodsService, private navController : NavController)\r\n  {\r\n  }\r\n\r\n  async ionViewDidEnter(){\r\n    const tmpMode : string=this.route.snapshot.paramMap.get('mode');\r\n    console.log('ionViewDidEnter');\r\n    if(tmpMode === 'false') // creation\r\n    {\r\n      this.ScanMode=false; // creation\r\n    }else if(tmpMode === 'true')\r\n    {\r\n      this.ScanMode=true;\r\n    }\r\n    this.storageService.init();\r\n\r\n    const factureName : string=this.route.snapshot.paramMap.get('factureName');\r\n    const description : string=this.route.snapshot.paramMap.get('description');\r\n    const tva : string=this.route.snapshot.paramMap.get('tva');\r\n    const typePay : string=this.route.snapshot.paramMap.get('typePay');\r\n    const remise : string=this.route.snapshot.paramMap.get('remise');\r\n    if(this.methodsService.isNullOrEmpty(this.formInv.get('factureName').value))\r\n    {\r\n      if(!this.methodsService.isNullOrEmpty(factureName))\r\n        this.formInv.get('factureName').setValue(factureName);\r\n      else this.formInv.get('factureName').setValue('');\r\n    }\r\n\r\n    if(this.methodsService.isNullOrEmpty(this.formInv.get('description').value))\r\n    {\r\n      if(!this.methodsService.isNullOrEmpty(description))\r\n        this.formInv.get('description').setValue(description);\r\n      else this.formInv.get('description').setValue('');\r\n    }\r\n\r\n    if(this.methodsService.isNullOrEmpty(this.formInv.get('tva').value))\r\n    {\r\n      if(!this.methodsService.isNullOrEmpty(tva))\r\n        this.formInv.get('tva').setValue(tva);\r\n      else this.formInv.get('tva').setValue('');\r\n    }\r\n\r\n    if(this.methodsService.isNullOrEmpty(this.formInv.get('typePay').value))\r\n    {\r\n      if(!this.methodsService.isNullOrEmpty(typePay))\r\n        this.formInv.get('typePay').setValue(typePay);\r\n      else this.formInv.get('typePay').setValue('');\r\n    }\r\n\r\n    if(this.methodsService.isNullOrEmpty(this.formInv.get('remise').value))\r\n    {\r\n      if(!this.methodsService.isNullOrEmpty(remise))\r\n        this.formInv.get('remise').setValue(remise);\r\n      else this.formInv.get('remise').setValue('');\r\n    }\r\n    if(this.chantierId === 'null')\r\n    {\r\n      let shopInvoice : Array<Facture> = await this.storageService.get('NAfactures');\r\n      this.panierList = shopInvoice.find(a => a.factureId === this.invoiceId).cart;\r\n    }\r\n    else\r\n    {\r\n      let chantiers : Array<Chantier> = await this.storageService.get('Chantiers');\r\n      let chantier = chantiers.find(a => a.chantierId === this.chantierId);\r\n      console.log(this.type);\r\n      if(this.type.toUpperCase() === 'DEVIS')\r\n      {\r\n        this.panierList = chantier.devis.find(a => a.factureId === this.invoiceId).cart;\r\n      }else\r\n      {\r\n        this.panierList = chantier.factures.find(a => a.factureId === this.invoiceId).cart;\r\n      }\r\n    }\r\n\r\n    let total = 0;\r\n    this.panierList.forEach(element => {\r\n      console.log('total value :' ,total);\r\n        total = total + (Number.parseFloat(element.product.priceHtva.toString()) * element.quantity);\r\n        total = Math.round(total * 100) / 100; // arrondi\r\n    });\r\n    this.formInv.get('priceHtva').setValue(total);\r\n    console.log('panier : ',this.panierList,this.chantierId);\r\n\r\n\r\n  }\r\n  async ngOnInit() {\r\n    const nowDate = new Date();\r\n    this.date = nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear();\r\n\r\n    const existId = this.route.snapshot.paramMap.get('factureId');\r\n    const invoiceId = this.route.snapshot.paramMap.get('invoiceId');\r\n    this.chantierId = this.route.snapshot.paramMap.get('chantierId');\r\n    const tmpMode : string=this.route.snapshot.paramMap.get('mode');\r\n    this.type = this.route.snapshot.paramMap.get('type'); // devis ou facture\r\n\r\n    const chantierl : Array<Chantier> = await this.storageService.get('Chantiers');\r\n    \r\n    if(this.chantierId!=null && this.chantierId !== 'null')\r\n    {\r\n      if(this.type === 'facture')\r\n        this.invList = chantierl.find(a => a.chantierId === this.chantierId).factures;\r\n      else this.invList = chantierl.find(a => a.chantierId === this.chantierId).devis;\r\n    }else this.invList = await this.storageService.get('NAfactures');\r\n\r\n    if(this.invList==null)\r\n      this.invList = new Array<Facture>();\r\n\r\n    if(tmpMode === 'false')\r\n    {\r\n      this.ScanMode=false;\r\n      this.mode = 'creation';\r\n    }else if(tmpMode === 'true')\r\n    {\r\n      this.ScanMode=true;\r\n      this.mode='scan';\r\n    }\r\n    if(existId!=null)\r\n    {\r\n      console.log('modification',existId);\r\n\r\n      this.indexFind =this.invList.findIndex(x => x.factureId === existId);\r\n      console.log('index :',this.indexFind,this.invList);\r\n      if(this.indexFind>=0)\r\n      {\r\n        this.invoiceId= this.invList[this.indexFind].factureId;\r\n        this.formInv.setValue({\r\n          factureName: this.invList[this.indexFind].factureName,\r\n          description:  this.invList[this.indexFind].description,\r\n          typePay:  this.invList[this.indexFind].typePay,\r\n          priceHtva:  this.invList[this.indexFind].priceHtva,\r\n          remise:  this.invList[this.indexFind].remise,\r\n          tva: this.invList[this.indexFind].tva,\r\n          totalPrice: this.invList[this.indexFind].totalPrice,\r\n        });\r\n        this.images=this.invList[this.indexFind].images;\r\n        this.mode = this.invList[this.indexFind].mode;\r\n        this.receivedMoney = this.invList[this.indexFind].receivedMoney;\r\n        console.log('mode ',this.mode);\r\n        console.log(this.invList[this.indexFind].cart);\r\n        if(this.mode === 'creation')\r\n          this.panierList = this.invList[this.indexFind].cart;\r\n        console.log(this.panierList);\r\n      }\r\n    }else {\r\n      console.log('creation : ',existId);\r\n      this.invoiceId= this.generateUUID();\r\n    }\r\n    if(this.mode === 'creation')\r\n    {\r\n      this.ScanMode=false;\r\n\r\n    }else if(this.mode === 'scan')\r\n    {\r\n      this.ScanMode=true;\r\n    }\r\n    if(invoiceId!=null)\r\n    {\r\n      this.invoiceId= invoiceId;\r\n      this.panierList= this.invList.find(a=>a.factureId === this.invoiceId).cart;\r\n      let total = 0;\r\n      this.panierList.forEach(element => {\r\n        console.log('total value :' ,total);\r\n          total = total + (Number.parseFloat(element.product.priceHtva.toString()) * element.quantity);\r\n          total = Math.round(total * 100) / 100; // arrondi\r\n      });\r\n      console.log('total value :' ,total);\r\n      this.formInv.get('priceHtva').setValue(total);\r\n    }\r\n    this.invSettings = await this.storageService.get('MyInvoiceSettings');\r\n    if(this.invSettings !== null)\r\n    {\r\n      console.log(this.invSettings);\r\n      let generatedName = '';\r\n\r\n      if(this.invSettings.positionApres)\r\n      {\r\n        generatedName += this.invSettings.factureName + this.invSettings.extType;\r\n      }\r\n      console.log(this.invSettings.exts, this.invSettings.exts.length);\r\n      if(this.invSettings.exts === 'Num')\r\n      {\r\n        generatedName += this.invSettings.extNum;\r\n        this.invSettings.extNum = Number.parseInt(this.invSettings.extNum.toString()) + 1;\r\n        console.log(generatedName);\r\n      }else if(this.invSettings.exts === 'Date')\r\n      {\r\n        generatedName += nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear();\r\n        console.log(generatedName);\r\n      }else if(this.invSettings.exts === 'NumDate')\r\n      {\r\n        generatedName += this.invSettings.extNum;\r\n        generatedName += '-'+nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear();\r\n\r\n        this.invSettings.extNum = Number.parseInt(this.invSettings.extNum.toString()) + 1;\r\n        console.log(generatedName);\r\n      }else if(this.invSettings.exts === 'DateNum')\r\n      {\r\n        generatedName += nowDate.getDate()+'/'+(nowDate.getMonth()+1)+'/'+nowDate.getFullYear();\r\n        generatedName += '-'+this.invSettings.extNum;\r\n\r\n        this.invSettings.extNum = Number.parseInt(this.invSettings.extNum.toString()) + 1;\r\n        console.log(generatedName);\r\n      }\r\n\r\n      if(this.invSettings.positionAvant)\r\n      {\r\n        generatedName += this.invSettings.extType + this.invSettings.factureName;\r\n      }\r\n      this.formInv.get('factureName').setValue(generatedName);\r\n    }\r\n    console.log('panier : ',this.panierList);\r\n  }\r\n\r\n  GoShopping()\r\n  {\r\n    if(this.chantierId !== 'null')\r\n    {\r\n      this.navController.navigateBack(['shop',{invoiceId : this.invoiceId,type : this.type,chantierId : this.chantierId,\r\n        factureName : this.formInv.get('factureName').value, remise : this.formInv.get('remise').value,\r\n        tva : this.formInv.get('tva').value, description : this.formInv.get('description').value,\r\n        typePay : this.formInv.get('typePay').value}]);\r\n    }else\r\n    {\r\n      this.navController.navigateBack(['shop',{invoiceId : this.invoiceId,type : this.type,chantierId : 'null',\r\n        factureName : this.formInv.get('factureName').value, remise : this.formInv.get('remise').value,\r\n        tva : this.formInv.get('tva').value, description : this.formInv.get('description').value,\r\n        typePay : this.formInv.get('typePay').value}]);\r\n    }\r\n    // this.navController.navigateBack(['shop',{invoiceId : this.invoiceId,type : this.type,chantierId : this.chantierId}],{replaceUrl:true});\r\n  }\r\n  async CreateWorksite() {\r\n\r\n  }\r\n\r\n  get f(){\r\n    return this.formInv.controls;\r\n  }\r\n\r\n  onFileChange(event) {\r\n    if (event.target.files && event.target.files[0])\r\n    {\r\n      const filesAmount = event.target.files.length;\r\n      for (let i = 0; i < filesAmount; i++)\r\n      {\r\n        const reader = new FileReader();\r\n        reader.onload = (event:any) =>\r\n        {\r\n          console.log(event.target.result);\r\n          this.images.push(event.target.result);\r\n          this.formInv.patchValue({\r\n          fileSource: this.images\r\n          });\r\n        }\r\n        reader.readAsDataURL(event.target.files[i]);\r\n      }\r\n    }\r\n  }\r\n  async onSubmit()\r\n  {\r\n    this.formInv.get('priceHtva').setValidators([Validators.required]);\r\n    this.formInv.get('priceHtva').updateValueAndValidity();\r\n\r\n    this.formInv.get('tva').setValidators([Validators.required]);\r\n    this.formInv.get('tva').updateValueAndValidity();\r\n\r\n    this.formInv.get('remise').setValidators([Validators.required]);\r\n    this.formInv.get('remise').updateValueAndValidity();\r\n\r\n    if(this.ScanMode)\r\n    {\r\n      this.formInv.get('tva').setValue(0);\r\n\r\n      this.formInv.get('remise').setValue(0);\r\n    }\r\n    console.log('form status',this.formInv);\r\n     const invalid = [];\r\n    const controls = this.formInv.controls;\r\n    for (const name in controls) {\r\n      if (controls[name].invalid) {\r\n        let nom='';\r\n        if(this.ScanMode)\r\n        if(name==='factureName')\r\n          nom='Nom facture';\r\n        if(name==='typePay')\r\n          nom='Type de paiement';\r\n        if(name==='priceHtva')\r\n          nom='Prix HTVA';\r\n        if(name==='tva')\r\n          nom='TVA';\r\n        if(name==='remise')\r\n          nom='Remise';\r\n        if(name==='totalPrice')\r\n          nom='Prix total';\r\n        invalid.push(nom);\r\n      }\r\n    }\r\n    if (!this.formInv.valid)\r\n    {\r\n      let res : string =null;\r\n      await this.modal.open('field',invalid.toString())\r\n      .then(result => result.result\r\n        .then((data) => {\r\n          res='OK';\r\n        }, (reason) => {\r\n        res='DISMISS' }\r\n        ));\r\n        return;\r\n    }\r\n\r\n    if(this.ScanMode === false)\r\n    {\r\n      let total=0;\r\n      let totalTva = 0;\r\n      var remise : string =this.formInv.get('remise').value;\r\n      remise = remise.toString().replace(',','.');\r\n      var htvaString : string = this.formInv.get('priceHtva').value;\r\n      htvaString = htvaString.toString().replace(',','.');\r\n      let htva :number = Number.parseFloat(htvaString);\r\n\r\n      var tvaString : string = this.formInv.get('tva').value;\r\n      tvaString = tvaString.toString().replace(',','.');\r\n      var tva :number = Number.parseFloat(tvaString);\r\n\r\n      if(!Number(remise.toString()))\r\n      {\r\n        console.log('pas un numeric',remise.toString());\r\n      }\r\n      if(!Number(htva.toString()))\r\n      {\r\n        console.log('pas un numeric',htva.toString());\r\n      }\r\n      if(!Number(tva.toString()))\r\n      {\r\n        console.log('pas un numeric',tva.toString());\r\n      }\r\n\r\n      if(Number.parseFloat(remise) !== 0)\r\n      {\r\n        htva = htva * (1 - Number.parseFloat(remise) / 100);\r\n        htva = Math.round(htva * 100) / 100; // arrondi\r\n\r\n      }\r\n      totalTva = htva / 100 * Number.parseFloat(tva.toString());\r\n      totalTva = Math.round(totalTva * 100) / 100; // arrondi\r\n\r\n      total= Number.parseFloat(htva.toString()) + totalTva;\r\n      total = Math.round(total * 100) / 100; // arrondi\r\n\r\n      console.log('Tva : ',tva);\r\n      console.log('TTva : ',totalTva);\r\n      console.log('htva : ',htva);\r\n\r\n\r\n      this.formInv.get('totalPrice').setValue(total);\r\n    }else this.formInv.get('totalPrice').setValue(this.formInv.get('priceHtva').value);\r\n    this.inv = new Facture(\r\n      this.invoiceId,\r\n      this.formInv.get('factureName').value,\r\n      this.formInv.get('description').value,\r\n      this.date,\r\n      this.formInv.get('typePay').value,\r\n      this.formInv.get('remise').value,\r\n      this.formInv.get('priceHtva').value,\r\n      this.formInv.get('tva').value,\r\n      this.formInv.get('totalPrice').value,\r\n      this.images,\r\n      this.receivedMoney,\r\n      this.panierList,\r\n      this.mode,\r\n      this.type,\r\n    );\r\n    console.log('list avant : ', this.invList);\r\n    if(this.indexFind>=0)\r\n    {\r\n      // this.invList.splice(this.indexFind,1);\r\n      this.invList[this.indexFind] = this.inv;\r\n    }else\r\n    {\r\n      const index=this.invList.findIndex(a => a.factureId === this.invoiceId);\r\n      if(index>=0)\r\n        this.invList[index]=this.inv;\r\n      else this.invList.push(this.inv);\r\n    }\r\n    console.log('list apres : ', this.invList);\r\n    this.storageService.set('MyInvoiceSettings',this.invSettings);\r\n    if(this.chantierId !== 'null')\r\n    {\r\n      const chantierl : Array<Chantier> = await this.storageService.get('Chantiers');\r\n      const chantier = chantierl.find(a => a.chantierId === this.chantierId);\r\n      const chantierIndex = chantierl.findIndex(a => a.chantierId === this.chantierId); \r\n      if(this.type === 'facture')\r\n        chantier.factures= this.invList;\r\n      else chantier.devis = this.invList;\r\n  \r\n      chantierl[chantierIndex] = chantier;\r\n      this.storageService.set('Chantiers',chantierl);\r\n      this.navController.navigateBack(['/worksite',{chantierId: this.chantierId}],{replaceUrl:true});\r\n    }else\r\n    {\r\n      let invs : Array<Facture> = await this.storageService.get('NAfactures');\r\n      if(invs === null)\r\n      {\r\n        invs = new Array<Facture>();\r\n      }\r\n      let existingInvoice = invs.findIndex(a => a.factureId === this.inv.factureId);\r\n      invs[existingInvoice] = this.inv;\r\n      this.storageService.set('NAfactures',invs);\r\n      this.navController.navigateBack(['/tb-home'],{replaceUrl:true});\r\n    }\r\n    console.log('invoice saved', this.invList);\r\n  }\r\n  generateUUID()\r\n  {\r\n      this.uuidValue=UUID.UUID();\r\n      return this.uuidValue;\r\n  }\r\n  resetImages()\r\n  {\r\n    this.images=[];\r\n  }\r\n  hideInput()\r\n  {\r\n    if(this.ScanMode === true)\r\n      this.ScanMode = false;\r\n    else  this.ScanMode = true;\r\n  }\r\n  async GoBack()\r\n  {\r\n    var result : string | undefined;\r\n    console.log(this.indexFind,this.formInv.value);\r\n    if(this.indexFind === null || this.indexFind === undefined || this.indexFind<0)\r\n    {\r\n      let cpt = 0;\r\n      Object.keys(this.formInv.controls).forEach(key => {\r\n        if(!this.methodsService.isNullOrEmpty(this.formInv.controls[key].value))\r\n        {\r\n          cpt ++;\r\n        }\r\n      });\r\n      if(cpt > 0)\r\n      {\r\n        result = await this.GoBackModal();\r\n      }\r\n    }else\r\n    {\r\n      if(!this.methodsService.equals(this.invList[this.indexFind].factureName,this.formInv.get('factureName').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].description,this.formInv.get('description').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].typePay,this.formInv.get('typePay').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].priceHtva.toString(),this.formInv.get('priceHtva').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].remise.toString(),this.formInv.get('remise').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].tva.toString(),this.formInv.get('tva').value) ||\r\n      !this.methodsService.equals(this.invList[this.indexFind].totalPrice.toString(),this.formInv.get('totalPrice').value))\r\n      {\r\n        result = await this.GoBackModal();\r\n      }\r\n    }\r\n    console.log(result);\r\n    if(result !== null)\r\n    {\r\n      this.cleanIncompleteInvoices();\r\n      if(this.chantierId === 'null')\r\n        this.navController.navigateBack(['/tb-home'],{replaceUrl:true});\r\n      else this.navController.navigateBack(['worksite',{chantierId: this.chantierId}],{replaceUrl:true});\r\n    }\r\n  }\r\n  async GoBackModal() : Promise<string>\r\n  {\r\n    let res : string =null;\r\n    await this.modal.open('exitPage','')\r\n    .then(result => result.result\r\n      .then((data) => {\r\n        res='OK';\r\n      }, (reason) => {\r\n      res='DISMISS'; }\r\n      ));\r\n    if(res === 'DISMISS')\r\n        return null;\r\n    return '';\r\n  }\r\n  async cleanIncompleteInvoices()\r\n  {\r\n    let indexToDelete : number = null;\r\n    let invoices : Array<Facture> = await this.storageService.get('NAfactures');\r\n    console.log(invoices)\r\n    invoices.forEach(invoice => {\r\n      console.log(invoice);\r\n      if(invoice.factureName == null || \r\n         invoice.priceHtva == null || \r\n         invoice.typePay == null ||\r\n         invoice.tva == null)\r\n         {\r\n          indexToDelete = invoices.findIndex(a => a === invoice);\r\n          console.log(indexToDelete,invoice);\r\n         }\r\n      if(indexToDelete !== null)\r\n      {\r\n        console.log('deleting',invoices,indexToDelete);\r\n        invoices.splice(indexToDelete,1);\r\n        indexToDelete = null;\r\n      }\r\n\r\n    });\r\n    this.storageService.set('NAfactures',invoices);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Directory, Filesystem } from '@capacitor/filesystem';\r\nimport jsPDF from 'jspdf';\r\nimport { Chantier } from '../models/chantier';\r\nimport { Facture } from '../models/facture';\r\nimport { User } from '../models/user';\r\nimport { StorageService } from './storage.service';\r\nimport { ToastController} from '@ionic/angular';\r\nimport { LocalNotifications } from '@ionic-native/local-notifications/ngx';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MethodsService {\r\n\r\n  constructor() { }\r\n    isNullOrEmpty(text : string) {\r\n    if(text === '' || text === null || text === undefined)\r\n        return true;\r\n    else return false;\r\n  }\r\n  equals(text1 : string, text2 : string) {\r\n    console.log(text1,text2);\r\n    if(text1 === '' || text1 === null || text1 === undefined)\r\n    {\r\n        if(text2 === '' || text2 === null || text2 === undefined)\r\n        {\r\n            return true;\r\n        }\r\n    }else\r\n    {\r\n        if(text1 === text2)\r\n        {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\n","\"use strict\";\nvar UUID = (function () {\n    function UUID() {\n        // no-op\n    }\n    UUID.UUID = function () {\n        if (typeof (window) !== \"undefined\" && typeof (window.crypto) !== \"undefined\" && typeof (window.crypto.getRandomValues) !== \"undefined\") {\n            // If we have a cryptographically secure PRNG, use that\n            // http://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript\n            var buf = new Uint16Array(8);\n            window.crypto.getRandomValues(buf);\n            return (this.pad4(buf[0]) + this.pad4(buf[1]) + \"-\" + this.pad4(buf[2]) + \"-\" + this.pad4(buf[3]) + \"-\" + this.pad4(buf[4]) + \"-\" + this.pad4(buf[5]) + this.pad4(buf[6]) + this.pad4(buf[7]));\n        }\n        else {\n            // Otherwise, just use Math.random\n            // https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n            // https://stackoverflow.com/questions/11605068/why-does-jshint-argue-against-bitwise-operators-how-should-i-express-this-code\n            return this.random4() + this.random4() + \"-\" + this.random4() + \"-\" + this.random4() + \"-\" +\n                this.random4() + \"-\" + this.random4() + this.random4() + this.random4();\n        }\n    };\n    UUID.pad4 = function (num) {\n        var ret = num.toString(16);\n        while (ret.length < 4) {\n            ret = \"0\" + ret;\n        }\n        return ret;\n    };\n    UUID.random4 = function () {\n        return Math.floor((1 + Math.random()) * 0x10000)\n            .toString(16)\n            .substring(1);\n    };\n    return UUID;\n}());\nexports.UUID = UUID;\n"],"names":["Component","UntypedFormGroup","UntypedFormControl","Validators","StorageService","UUID","ActivatedRoute","Router","Facture","NgbModal","NgbdModalFocus","NavController","MethodsService","Invoice","constructor","modalS","storageService","router","route","methodsService","navController","factureName","required","description","typePay","priceHtva","pattern","numericNumberReg","tva","remise","totalPrice","ionViewDidEnter","tmpMode","snapshot","paramMap","get","console","log","ScanMode","init","isNullOrEmpty","formInv","value","setValue","chantierId","shopInvoice","panierList","find","a","factureId","invoiceId","cart","chantiers","chantier","type","toUpperCase","devis","factures","total","forEach","element","Number","parseFloat","product","toString","quantity","Math","round","ngOnInit","nowDate","Date","date","getDate","getMonth","getFullYear","existId","chantierl","invList","Array","mode","indexFind","findIndex","x","images","receivedMoney","generateUUID","invSettings","generatedName","positionApres","extType","exts","length","extNum","parseInt","positionAvant","GoShopping","navigateBack","CreateWorksite","f","controls","onFileChange","event","target","files","filesAmount","i","reader","FileReader","onload","result","push","patchValue","fileSource","readAsDataURL","onSubmit","setValidators","updateValueAndValidity","invalid","name","nom","valid","res","modal","open","then","data","reason","totalTva","replace","htvaString","htva","tvaString","inv","index","set","chantierIndex","replaceUrl","invs","existingInvoice","uuidValue","resetImages","hideInput","GoBack","undefined","cpt","Object","keys","key","GoBackModal","equals","cleanIncompleteInvoices","indexToDelete","invoices","invoice","splice","selector","template","window","crypto","getRandomValues","buf","Uint16Array","pad4","random4","num","ret","floor","random","substring","exports"],"sourceRoot":"webpack:///"}