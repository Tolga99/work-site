{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { NgbdModalFocus } from '../modal/modal-focus';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"../services/storage.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/menu\";\nimport * as i8 from \"@angular/material/icon\";\nimport * as i9 from \"@ngx-translate/core\";\n\nfunction Articles_mat_card_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-card\", 13);\n    i0.ɵɵelementStart(1, \"mat-card-title-group\", 0);\n    i0.ɵɵlistener(\"click\", function Articles_mat_card_10_Template_mat_card_title_group_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const el_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.EnterCategory(el_r3);\n    });\n    i0.ɵɵelementStart(2, \"mat-card-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-card-subtitle\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"img\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function Articles_mat_card_10_Template_button_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const el_r3 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.ModifyCategory(el_r3);\n    });\n    i0.ɵɵtext(8, \"...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const el_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(el_r3.categoryName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(el_r3.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", el_r3.categoryImage, i0.ɵɵsanitizeUrl);\n    i0.ɵɵproperty(\"border\", 0);\n  }\n}\n\nfunction Articles_th_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const head_r7 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", head_r7, \" \");\n  }\n}\n\nfunction Articles_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 17);\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 0);\n    i0.ɵɵlistener(\"click\", function Articles_tr_26_Template_td_click_7_listener($event) {\n      return $event.stopPropagation();\n    });\n    i0.ɵɵelementStart(8, \"button\", 18);\n    i0.ɵɵelementStart(9, \"mat-icon\");\n    i0.ɵɵtext(10, \"more_horiz\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"mat-menu\", null, 19);\n    i0.ɵɵelementStart(13, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function Articles_tr_26_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const p_r8 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.ModifyProduct(p_r8);\n    });\n    i0.ɵɵelementStart(14, \"mat-icon\");\n    i0.ɵɵtext(15, \"edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"span\");\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function Articles_tr_26_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const p_r8 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.DeleteProduct(p_r8);\n    });\n    i0.ɵɵelementStart(20, \"mat-icon\");\n    i0.ɵɵtext(21, \"delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"span\");\n    i0.ɵɵtext(23);\n    i0.ɵɵpipe(24, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n\n    const _r9 = i0.ɵɵreference(12);\n\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.priceHtva);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"matMenuTriggerFor\", _r9);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 6, \"edit\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(24, 8, \"delete\"));\n  }\n}\n\nexport let Articles = /*#__PURE__*/(() => {\n  class Articles {\n    constructor(modalS, storageService, router, route) {\n      this.modalS = modalS;\n      this.storageService = storageService;\n      this.router = router;\n      this.route = route;\n      this.headElementsArt = ['Nom article', 'Description', 'Prix HTVA', 'Catégorie'];\n      this.artList = [];\n      this.catList = [];\n      this.actualCat = null;\n      this.modal = new NgbdModalFocus(this.modalS);\n    }\n\n    ionViewDidEnter() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.catList = yield this.storageService.get('Categories');\n        this.actualCat = this.catList.find(a => a.categoryId === this.route.snapshot.paramMap.get('actualCat'));\n        this.EnterCategory(this.actualCat);\n      });\n    }\n\n    ngOnInit() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.storageService.init();\n        this.artList = yield this.storageService.get('Articles');\n        this.catList = yield this.storageService.get('Categories');\n        if (this.catList != null) this.catList = this.catList.filter(a => a.categoryParent == null);\n        this.catList.forEach(element => {\n          if (element.categoryImage == null) element.categoryImage = '..//resources//White-square.jpg';\n        });\n      });\n    }\n\n    CreateCategory() {\n      console.log('Bouton nv cat');\n      if (this.actualCat != null) this.router.navigate(['category-form', {\n        actualCat: this.actualCat.categoryId\n      }], {\n        replaceUrl: true\n      });else this.router.navigate(['category-form']);\n    }\n\n    ModifyCategory(c) {\n      var _a;\n\n      console.log(c);\n      if (c != null) this.router.navigate(['category-form', {\n        actualCat: (_a = this.actualCat) === null || _a === void 0 ? void 0 : _a.categoryId,\n        modifCat: c === null || c === void 0 ? void 0 : c.categoryId,\n        modif: 'YES'\n      }], {\n        replaceUrl: true\n      });else this.router.navigate(['category-form', {\n        modif: 'YES'\n      }], {\n        replaceUrl: true\n      });\n    }\n\n    EnterCategory(c) {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.actualCat = c;\n        this.artList = yield this.storageService.get('Articles'); // Dans les 2 cas on a besoin de la liste complete et actualisée\n\n        if (this.actualCat == null) {\n          this.catList = yield this.storageService.get('Categories');\n          if (this.catList != null) this.catList = this.catList.filter(a => a.categoryParent == null);\n        } else {\n          this.catList = this.actualCat.subCategories;\n          if (this.artList != null) this.artList = this.artList.filter(a => a.categoryId === this.actualCat.categoryId);\n        } // + refresh la liste en dessous avec les articles filtrés AUSSI\n\n      });\n    }\n\n    BackCategory() {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (this.actualCat == null) this.EnterCategory(null);else this.EnterCategory(this.actualCat.categoryParent); // REfresh articles\n      });\n    }\n\n    CreateProduct() {\n      if (this.actualCat != null) this.router.navigate(['article-form', {\n        actualCat: this.actualCat.categoryId\n      }], {\n        replaceUrl: true\n      });else this.router.navigate(['article-form']);\n    }\n\n    ModifyProduct(p) {\n      console.log(p);\n      if (p != null) this.router.navigate(['article-form', {\n        modifArt: p.productId,\n        modif: 'YES'\n      }], {\n        replaceUrl: true\n      });else this.router.navigate(['article-form', {\n        modif: 'YES'\n      }], {\n        replaceUrl: true\n      });\n    }\n\n    DeleteProduct(p) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let res = null;\n        yield this.modal.open('delArt', p.productName).then(result => result.result.then(data => {\n          res = 'OK';\n        }, reason => {\n          res = 'DISMISS';\n        }));\n        if (res === 'DISMISS') return;\n      });\n    }\n\n    DeleteCategory(c) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let res = null;\n        yield this.modal.open('delCat', c.categoryName).then(result => result.result.then(data => {\n          res = 'OK';\n        }, reason => {\n          res = 'DISMISS';\n        }));\n        if (res === 'DISMISS') return;\n      });\n    }\n\n    GoBack() {\n      this.router.navigate(['tb-settings'], {\n        replaceUrl: true\n      });\n    }\n\n  }\n\n  Articles.ɵfac = function Articles_Factory(t) {\n    return new (t || Articles)(i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.StorageService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n  };\n\n  Articles.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: Articles,\n    selectors: [[\"app-articles\"]],\n    decls: 31,\n    vars: 12,\n    consts: [[3, \"click\"], [\"name\", \"arrow-back\"], [2, \"overflow-y\", \"auto\"], [1, \"container\", 2, \"overflow-y\", \"auto\"], [1, \"row\"], [\"class\", \"example-card col-4\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-footer\", \"text-muted\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"card-header\"], [1, \"col-auto\", \"table-wrapper-scroll-y\", \"my-custom-scrollbar\"], [1, \"table\", \"table-bordered\", \"table-striped\", \"mb-0\"], [\"scope\", \"col\", 4, \"ngFor\", \"ngForOf\"], [\"mdbTableCol\", \"\", 4, \"ngFor\", \"ngForOf\"], [1, \"example-card\", \"col-4\"], [\"mat-card-lg-image\", \"\", \"alt\", \"Null\", \"onerror\", \"this.onerror=null; this.src='assets/icon/White-square.jpg'\", 1, \"img-fluid\", 2, \"max-width\", \"70px\", \"max-height\", \"70px\", 3, \"src\", \"border\"], [\"type\", \"button\", 3, \"click\"], [\"scope\", \"col\"], [\"mdbTableCol\", \"\"], [\"mat-icon-button\", \"\", \"type\", \"button\", 3, \"matMenuTriggerFor\"], [\"menu\", \"matMenu\"], [\"mat-menu-item\", \"\", \"type\", \"button\", 3, \"click\"]],\n    template: function Articles_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\");\n        i0.ɵɵelementStart(1, \"ion-toolbar\");\n        i0.ɵɵelementStart(2, \"ion-button\", 0);\n        i0.ɵɵlistener(\"click\", function Articles_Template_ion_button_click_2_listener() {\n          return ctx.GoBack();\n        });\n        i0.ɵɵelement(3, \"ion-icon\", 1);\n        i0.ɵɵelementStart(4, \"ion-label\");\n        i0.ɵɵtext(5);\n        i0.ɵɵpipe(6, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 2);\n        i0.ɵɵelementStart(8, \"div\", 3);\n        i0.ɵɵelementStart(9, \"div\", 4);\n        i0.ɵɵtemplate(10, Articles_mat_card_10_Template, 9, 4, \"mat-card\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 6);\n        i0.ɵɵelementStart(12, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function Articles_Template_button_click_12_listener() {\n          return ctx.BackCategory();\n        });\n        i0.ɵɵtext(13, \"Go back\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function Articles_Template_button_click_14_listener() {\n          return ctx.CreateCategory();\n        });\n        i0.ɵɵtext(15, \"Nouvelle cat\\u00E9gorie\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"hr\");\n        i0.ɵɵelementStart(17, \"div\", 8);\n        i0.ɵɵtext(18);\n        i0.ɵɵpipe(19, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 9);\n        i0.ɵɵelementStart(21, \"table\", 10);\n        i0.ɵɵelementStart(22, \"thead\");\n        i0.ɵɵelementStart(23, \"tr\");\n        i0.ɵɵtemplate(24, Articles_th_24_Template, 2, 1, \"th\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"tbody\");\n        i0.ɵɵtemplate(26, Articles_tr_26_Template, 25, 10, \"tr\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 6);\n        i0.ɵɵelementStart(28, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function Articles_Template_button_click_28_listener() {\n          return ctx.CreateProduct();\n        });\n        i0.ɵɵtext(29);\n        i0.ɵɵpipe(30, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 6, \"back\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.catList);\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(19, 8, \"myArticles\"), \" \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.headElementsArt);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.artList);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(30, 10, \"new product\"));\n      }\n    },\n    directives: [i4.IonHeader, i4.IonToolbar, i4.IonButton, i4.IonIcon, i4.IonLabel, i5.NgForOf, i6.MatCard, i6.MatCardTitleGroup, i6.MatCardTitle, i6.MatCardSubtitle, i6.MatCardLgImage, i7.MatMenuTrigger, i8.MatIcon, i7.MatMenu, i7.MatMenuItem],\n    pipes: [i9.TranslatePipe],\n    styles: [\"@charset \\\"UTF-8\\\";.example-card[_ngcontent-%COMP%]{max-width:400px;margin:30px;padding:20px}.container[_ngcontent-%COMP%]{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}\"]\n  });\n  return Articles;\n})();","map":null,"metadata":{},"sourceType":"module"}